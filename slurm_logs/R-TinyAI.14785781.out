## SLURM PROLOG ###############################################################
##    Job ID : 14785781
##  Job Name : TinyAI
##  Nodelist : gpu2003
##      CPUs : 1
##  Mem/Node : 64000 MB
## Directory : /oscar/home/bpeckham/TinyAI
##   Job Started : Wed Dec 10 02:34:54 PM EST 2025
###############################################################################

==========================================
Job started at: Wed Dec 10 02:34:54 PM EST 2025
Job ID: 14785781
Node: gpu2003
==========================================

Python location: /users/bpeckham/.conda/envs/tinyai/bin/python
Python version: Python 3.10.19
Conda environment: tinyai
Installing/verifying required packages...
TensorFlow 2.15.0 and NumPy 1.26.4 imported successfully
GPU Information:
Wed Dec 10 14:35:22 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  Quadro RTX 6000                On  | 00000000:40:00.0 Off |                  Off |
| 33%   31C    P8               5W / 260W |     10MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     30829      G   /usr/libexec/Xorg                             8MiB |
+---------------------------------------------------------------------------------------+

TensorFlow GPU Detection:
TF version: 2.15.0
Built with CUDA: True
GPUs detected: 0
GPU devices: []

==========================================
Starting main Python script at Wed Dec 10 02:35:26 PM EST 2025
==========================================

Configuration:
  d_model: 64
  num_layers: 2
  num_heads: 4
  ff_dim: 128
  deep_rec_cycles: 2
  num_l_steps: 3
  epochs: 15
  batch_size: 8
  learning_rate: 1e-4
  max_seq_length: 128

To monitor training with WandB:
  1. First, log in to WandB (one time only):
     python wandb_login.py
  2. Then view metrics at: https://wandb.ai
  (No port forwarding needed - metrics upload automatically!)


============================================================
TinyAI TRAINING SCRIPT
============================================================

Configuration:
  Data path: /oscar/home/bpeckham/TinyAI/preprocessing/data/final_train_data.txt
  Vocab path: /oscar/home/bpeckham/TinyAI/preprocessing/data/vocab.json
  Max sequence length: 128
  Model dimension: 64
  Layers: 2
  Heads: 4
  FF dim: 128
  Dropout: 0.1
  Deep recursion cycles: 2
  Inner iterations: 3
  Deep supervision steps: 2
  Batch size: 8
  Epochs: 15
  Learning rate: 0.0001
============================================================

Loading tokenizer...
Loaded vocabulary with 7173 tokens
  PAD=0, UNK=1, BOS=18, EOS=2
Loading data...
Loaded 14180 samples
Train: 11344, Val: 1418, Test: 1418

############################################################
# CONTROL TRANSFORMER
############################################################

Control Model Parameters: 1,000,709

============================================================
TRAINING CONTROL TRANSFORMER (Single-Pass Baseline)
============================================================


Epoch 1/15
----------------------------------------
  Batch 50: Loss=8.6110, Acc=0.0253
  Batch 100: Loss=8.0940, Acc=0.0645
  Batch 150: Loss=7.6113, Acc=0.0577
  Batch 200: Loss=7.2928, Acc=0.0377
  Batch 250: Loss=6.9648, Acc=0.0470
  Batch 300: Loss=6.6998, Acc=0.0589
  Batch 350: Loss=6.3882, Acc=0.0466
  Batch 400: Loss=6.2248, Acc=0.0621
  Batch 450: Loss=6.1751, Acc=0.0661
  Batch 500: Loss=5.8802, Acc=0.0635
  Batch 550: Loss=6.1685, Acc=0.0797
  Batch 600: Loss=6.0352, Acc=0.0798
  Batch 650: Loss=5.9724, Acc=0.0934
  Batch 700: Loss=5.8225, Acc=0.1193
  Batch 750: Loss=5.9317, Acc=0.1220
  Batch 800: Loss=6.0025, Acc=0.1220
  Batch 850: Loss=5.7995, Acc=0.1592
  Batch 900: Loss=5.7328, Acc=0.1477
  Batch 950: Loss=5.6360, Acc=0.1873
  Batch 1000: Loss=5.6677, Acc=0.1734
  Batch 1050: Loss=5.4974, Acc=0.1724
  Batch 1100: Loss=5.5826, Acc=0.1795
  Batch 1150: Loss=5.4306, Acc=0.1557
  Batch 1200: Loss=5.2997, Acc=0.2118
  Batch 1250: Loss=5.2122, Acc=0.1926
  Batch 1300: Loss=5.3374, Acc=0.2296
  Batch 1350: Loss=5.1668, Acc=0.1925
  Batch 1400: Loss=5.1684, Acc=0.1774

  Train Loss: 6.1699, Train Acc: 0.1178
  Val Loss: 5.0506, Val Acc: 0.2170
  âœ“ Saved best model (val_loss=5.0506)

Epoch 2/15
----------------------------------------
  Batch 50: Loss=4.9601, Acc=0.2303
  Batch 100: Loss=4.8432, Acc=0.2412
  Batch 150: Loss=4.7272, Acc=0.2201
  Batch 200: Loss=4.9567, Acc=0.2425
  Batch 250: Loss=4.9420, Acc=0.2302
  Batch 300: Loss=4.7421, Acc=0.2623
  Batch 350: Loss=4.7960, Acc=0.2358
  Batch 400: Loss=4.9938, Acc=0.2379
  Batch 450: Loss=4.7606, Acc=0.2467
  Batch 500: Loss=4.8443, Acc=0.2545
  Batch 550: Loss=4.9508, Acc=0.2398
