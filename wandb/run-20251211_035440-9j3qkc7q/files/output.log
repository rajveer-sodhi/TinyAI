
Epoch 1/20
----------------------------------------
  Batch 50: Loss=8.4561, Acc=0.0442
  Batch 100: Loss=7.0474, Acc=0.0297
  Batch 150: Loss=6.2257, Acc=0.0341
  Batch 200: Loss=6.0191, Acc=0.0452
  Batch 250: Loss=6.0565, Acc=0.0926
  Batch 300: Loss=5.6692, Acc=0.1631
  Batch 350: Loss=5.4996, Acc=0.1686
  Batch 400: Loss=5.6098, Acc=0.1744
  Batch 450: Loss=5.7013, Acc=0.1637
  Batch 500: Loss=5.3674, Acc=0.1971
  Batch 550: Loss=4.7889, Acc=0.2574
  Batch 600: Loss=5.0451, Acc=0.2479
  Batch 650: Loss=4.6231, Acc=0.2574
  Batch 700: Loss=4.9092, Acc=0.2608

  Train Loss: 5.9051, Train Acc: 0.1435
  Val Loss: 4.7276, Val Acc: 0.2464
  ✓ Saved best model (val_loss=4.7276)

Epoch 2/20
----------------------------------------
  Batch 50: Loss=5.1294, Acc=0.2214
  Batch 100: Loss=5.1678, Acc=0.2244
  Batch 150: Loss=4.5177, Acc=0.2455
  Batch 200: Loss=4.5295, Acc=0.2649
  Batch 250: Loss=4.5307, Acc=0.2613
  Batch 300: Loss=4.5726, Acc=0.2859
  Batch 350: Loss=4.5011, Acc=0.2443
  Batch 400: Loss=4.5437, Acc=0.2440
  Batch 450: Loss=4.7217, Acc=0.2628
  Batch 500: Loss=4.3878, Acc=0.2814
  Batch 550: Loss=4.3317, Acc=0.2640
  Batch 600: Loss=4.3569, Acc=0.2602
  Batch 650: Loss=4.4551, Acc=0.2608
  Batch 700: Loss=4.5110, Acc=0.2412

  Train Loss: 4.6031, Train Acc: 0.2506
  Val Loss: 4.3920, Val Acc: 0.2672
  ✓ Saved best model (val_loss=4.3920)

Epoch 3/20
----------------------------------------
  Batch 50: Loss=4.5361, Acc=0.2585
  Batch 100: Loss=4.5533, Acc=0.2695
  Batch 150: Loss=4.0870, Acc=0.2841
  Batch 200: Loss=4.5685, Acc=0.2421
  Batch 250: Loss=4.3887, Acc=0.2900
  Batch 300: Loss=4.1112, Acc=0.2734
  Batch 350: Loss=4.2108, Acc=0.2823
  Batch 400: Loss=4.7111, Acc=0.2278
  Batch 450: Loss=4.4211, Acc=0.2604
  Batch 500: Loss=4.4047, Acc=0.2515
  Batch 550: Loss=4.8639, Acc=0.2279
  Batch 600: Loss=4.3341, Acc=0.2581
  Batch 650: Loss=4.4222, Acc=0.2513
  Batch 700: Loss=4.3056, Acc=0.2546

  Train Loss: 4.3695, Train Acc: 0.2638
  Val Loss: 4.2791, Val Acc: 0.2775
  ✓ Saved best model (val_loss=4.2791)

Epoch 4/20
----------------------------------------
  Batch 50: Loss=4.3010, Acc=0.2500
  Batch 100: Loss=4.7254, Acc=0.2432
  Batch 150: Loss=4.3089, Acc=0.2902
  Batch 200: Loss=4.1799, Acc=0.2475
  Batch 250: Loss=4.4955, Acc=0.2505
  Batch 300: Loss=4.4351, Acc=0.2754
  Batch 350: Loss=3.9533, Acc=0.2712
  Batch 400: Loss=4.2894, Acc=0.2780
  Batch 450: Loss=4.4516, Acc=0.2725
  Batch 500: Loss=4.1931, Acc=0.2467
  Batch 550: Loss=4.1139, Acc=0.2953
  Batch 600: Loss=4.8590, Acc=0.2495
  Batch 650: Loss=4.4505, Acc=0.2621
  Batch 700: Loss=3.9960, Acc=0.2851

  Train Loss: 4.2589, Train Acc: 0.2699
  Val Loss: 4.2159, Val Acc: 0.2813
  ✓ Saved best model (val_loss=4.2159)

Epoch 5/20
----------------------------------------
  Batch 50: Loss=4.4812, Acc=0.2578
  Batch 100: Loss=4.2945, Acc=0.2594
  Batch 150: Loss=4.2353, Acc=0.3125
  Batch 200: Loss=4.1130, Acc=0.2872
  Batch 250: Loss=3.9105, Acc=0.3225
  Batch 300: Loss=4.3006, Acc=0.2745
  Batch 350: Loss=4.1295, Acc=0.2873
  Batch 400: Loss=4.0418, Acc=0.2599
  Batch 450: Loss=3.9587, Acc=0.2901
  Batch 500: Loss=3.9504, Acc=0.2770
  Batch 550: Loss=4.2967, Acc=0.2710
  Batch 600: Loss=4.5422, Acc=0.2923
  Batch 650: Loss=4.1464, Acc=0.2979
  Batch 700: Loss=4.4314, Acc=0.2411

  Train Loss: 4.1811, Train Acc: 0.2757
  Val Loss: 4.1604, Val Acc: 0.2889
  ✓ Saved best model (val_loss=4.1604)

Epoch 6/20
----------------------------------------
  Batch 50: Loss=4.4031, Acc=0.2520
  Batch 100: Loss=3.7172, Acc=0.3140
  Batch 150: Loss=4.2133, Acc=0.2659
  Batch 200: Loss=4.1379, Acc=0.2779
  Batch 250: Loss=3.8376, Acc=0.2923
  Batch 300: Loss=4.0436, Acc=0.3067
  Batch 350: Loss=4.4335, Acc=0.2654
  Batch 400: Loss=4.0760, Acc=0.2897
  Batch 450: Loss=4.3777, Acc=0.2730
  Batch 500: Loss=4.1292, Acc=0.2675
  Batch 550: Loss=4.2610, Acc=0.2726
  Batch 600: Loss=3.9631, Acc=0.2990
  Batch 650: Loss=3.6882, Acc=0.3379
  Batch 700: Loss=3.9770, Acc=0.2876

  Train Loss: 4.1207, Train Acc: 0.2795
  Val Loss: 4.1238, Val Acc: 0.2950
  ✓ Saved best model (val_loss=4.1238)

Epoch 7/20
----------------------------------------
  Batch 50: Loss=4.2510, Acc=0.2815
  Batch 100: Loss=4.1347, Acc=0.2477
  Batch 150: Loss=4.0659, Acc=0.2701
  Batch 200: Loss=4.2791, Acc=0.2569
  Batch 250: Loss=4.1145, Acc=0.2530
  Batch 300: Loss=3.9896, Acc=0.3068
  Batch 350: Loss=4.3196, Acc=0.2765
  Batch 400: Loss=4.1951, Acc=0.2492
  Batch 450: Loss=4.1027, Acc=0.3148
  Batch 500: Loss=3.8064, Acc=0.3038
  Batch 550: Loss=4.0826, Acc=0.2658
  Batch 600: Loss=3.8832, Acc=0.2882
  Batch 650: Loss=3.8154, Acc=0.3153
  Batch 700: Loss=4.3021, Acc=0.2606

  Train Loss: 4.0727, Train Acc: 0.2826
  Val Loss: 4.0855, Val Acc: 0.2989
  ✓ Saved best model (val_loss=4.0855)

Epoch 8/20
----------------------------------------
  Batch 50: Loss=4.1504, Acc=0.2768
  Batch 100: Loss=4.1041, Acc=0.2941
  Batch 150: Loss=4.3109, Acc=0.2748
  Batch 200: Loss=4.0822, Acc=0.2840
  Batch 250: Loss=4.1224, Acc=0.2525
  Batch 300: Loss=3.9255, Acc=0.2885
  Batch 350: Loss=4.0589, Acc=0.2825
  Batch 400: Loss=4.0604, Acc=0.2781
  Batch 450: Loss=3.9396, Acc=0.2842
  Batch 500: Loss=3.7756, Acc=0.3134
  Batch 550: Loss=4.2948, Acc=0.2982
  Batch 600: Loss=4.2250, Acc=0.2661
  Batch 650: Loss=3.8758, Acc=0.3126
  Batch 700: Loss=4.1149, Acc=0.3045

  Train Loss: 4.0296, Train Acc: 0.2851
  Val Loss: 4.0532, Val Acc: 0.3031
  ✓ Saved best model (val_loss=4.0532)

Epoch 9/20
----------------------------------------
  Batch 50: Loss=4.0403, Acc=0.2891
  Batch 100: Loss=3.8402, Acc=0.3109
  Batch 150: Loss=4.0319, Acc=0.2886
  Batch 200: Loss=3.9056, Acc=0.2936
  Batch 250: Loss=4.0415, Acc=0.2806
  Batch 300: Loss=4.0669, Acc=0.2963
  Batch 350: Loss=4.0888, Acc=0.2815
  Batch 400: Loss=3.6155, Acc=0.3281
  Batch 450: Loss=3.8402, Acc=0.2805
  Batch 500: Loss=4.1371, Acc=0.2764
  Batch 550: Loss=3.8954, Acc=0.2638
  Batch 600: Loss=3.8761, Acc=0.3040
  Batch 650: Loss=3.9980, Acc=0.2732
  Batch 700: Loss=3.8852, Acc=0.3019

  Train Loss: 3.9913, Train Acc: 0.2868
  Val Loss: 4.0199, Val Acc: 0.3062
  ✓ Saved best model (val_loss=4.0199)

Epoch 10/20
----------------------------------------
  Batch 50: Loss=3.5760, Acc=0.3251
  Batch 100: Loss=3.6603, Acc=0.3265
  Batch 150: Loss=4.0525, Acc=0.2699
  Batch 200: Loss=3.9448, Acc=0.2827
  Batch 250: Loss=4.0103, Acc=0.2795
  Batch 300: Loss=3.9659, Acc=0.2584
  Batch 350: Loss=4.1886, Acc=0.2997
  Batch 400: Loss=4.2753, Acc=0.2630
  Batch 450: Loss=4.0478, Acc=0.2657
  Batch 500: Loss=3.5518, Acc=0.3166
  Batch 550: Loss=3.9808, Acc=0.2705
  Batch 600: Loss=3.8246, Acc=0.2812
  Batch 650: Loss=4.4076, Acc=0.2471
  Batch 700: Loss=3.8421, Acc=0.2800

  Train Loss: 3.9581, Train Acc: 0.2875
  Val Loss: 3.9894, Val Acc: 0.3100
  ✓ Saved best model (val_loss=3.9894)

Epoch 11/20
----------------------------------------
  Batch 50: Loss=3.7638, Acc=0.2937
  Batch 100: Loss=3.7414, Acc=0.2756
  Batch 150: Loss=4.0803, Acc=0.2727
  Batch 200: Loss=3.8681, Acc=0.3021
  Batch 250: Loss=4.0276, Acc=0.2951
  Batch 300: Loss=3.8086, Acc=0.2895
  Batch 350: Loss=3.7662, Acc=0.3340
  Batch 400: Loss=3.8283, Acc=0.2926
  Batch 450: Loss=3.9931, Acc=0.3061
  Batch 500: Loss=3.8218, Acc=0.3231
  Batch 550: Loss=4.0764, Acc=0.2968
  Batch 600: Loss=3.9178, Acc=0.2977
  Batch 650: Loss=3.6901, Acc=0.3244
  Batch 700: Loss=3.9553, Acc=0.2834

  Train Loss: 3.9236, Train Acc: 0.2896
  Val Loss: 3.9599, Val Acc: 0.3147
  ✓ Saved best model (val_loss=3.9599)

Epoch 12/20
----------------------------------------
  Batch 50: Loss=3.7446, Acc=0.3114
  Batch 100: Loss=3.8019, Acc=0.3024
  Batch 150: Loss=4.1652, Acc=0.2638
  Batch 200: Loss=3.9057, Acc=0.2762
  Batch 250: Loss=4.0286, Acc=0.2941
  Batch 300: Loss=3.8838, Acc=0.3137
  Batch 350: Loss=3.7439, Acc=0.3038
  Batch 400: Loss=4.1507, Acc=0.3142
  Batch 450: Loss=3.8516, Acc=0.2755
  Batch 500: Loss=3.7103, Acc=0.2899
  Batch 550: Loss=3.9945, Acc=0.3036
  Batch 600: Loss=3.7774, Acc=0.2894
  Batch 650: Loss=4.0935, Acc=0.2618
  Batch 700: Loss=3.4666, Acc=0.3410

  Train Loss: 3.8945, Train Acc: 0.2910
  Val Loss: 3.9288, Val Acc: 0.3172
  ✓ Saved best model (val_loss=3.9288)

Epoch 13/20
----------------------------------------
  Batch 50: Loss=3.8236, Acc=0.2834
  Batch 100: Loss=3.4343, Acc=0.3340
  Batch 150: Loss=3.8543, Acc=0.3036
  Batch 200: Loss=3.6735, Acc=0.2874
  Batch 250: Loss=4.0351, Acc=0.2785
  Batch 300: Loss=3.9483, Acc=0.2743
  Batch 350: Loss=3.5601, Acc=0.3303
  Batch 400: Loss=3.8003, Acc=0.2878
  Batch 450: Loss=3.8989, Acc=0.2802
  Batch 500: Loss=3.9002, Acc=0.2975
  Batch 550: Loss=3.6335, Acc=0.3279
  Batch 600: Loss=4.1676, Acc=0.2844
  Batch 650: Loss=3.9985, Acc=0.2628
  Batch 700: Loss=4.0616, Acc=0.2847

  Train Loss: 3.8692, Train Acc: 0.2923
  Val Loss: 3.9067, Val Acc: 0.3197
  ✓ Saved best model (val_loss=3.9067)

Epoch 14/20
----------------------------------------
  Batch 50: Loss=3.7608, Acc=0.3043
  Batch 100: Loss=3.9881, Acc=0.2770
  Batch 150: Loss=3.8980, Acc=0.3167
  Batch 200: Loss=3.8742, Acc=0.3095
  Batch 250: Loss=3.7283, Acc=0.3169
  Batch 300: Loss=3.7626, Acc=0.3010
  Batch 350: Loss=3.8875, Acc=0.2940
  Batch 400: Loss=3.8448, Acc=0.2950
  Batch 450: Loss=3.3712, Acc=0.3431
  Batch 500: Loss=3.9806, Acc=0.2704
  Batch 550: Loss=4.0427, Acc=0.3036
  Batch 600: Loss=3.6479, Acc=0.3124
  Batch 650: Loss=4.1053, Acc=0.2782
  Batch 700: Loss=3.8843, Acc=0.2885

  Train Loss: 3.8461, Train Acc: 0.2935
  Val Loss: 3.8773, Val Acc: 0.3232
  ✓ Saved best model (val_loss=3.8773)

Epoch 15/20
----------------------------------------
  Batch 50: Loss=3.8279, Acc=0.3046
  Batch 100: Loss=4.1343, Acc=0.2747
  Batch 150: Loss=3.8676, Acc=0.3165
  Batch 200: Loss=3.6147, Acc=0.3180
  Batch 250: Loss=3.7294, Acc=0.2857
  Batch 300: Loss=3.9858, Acc=0.2808
  Batch 350: Loss=3.6598, Acc=0.3033
  Batch 400: Loss=3.4631, Acc=0.3500
  Batch 450: Loss=3.8375, Acc=0.3002
  Batch 500: Loss=3.9622, Acc=0.2797
  Batch 550: Loss=4.1224, Acc=0.2706
  Batch 600: Loss=4.2393, Acc=0.2615
  Batch 650: Loss=3.6903, Acc=0.3131
  Batch 700: Loss=3.9166, Acc=0.2925

  Train Loss: 3.8251, Train Acc: 0.2947
  Val Loss: 3.8608, Val Acc: 0.3258
  ✓ Saved best model (val_loss=3.8608)

Epoch 16/20
----------------------------------------
  Batch 50: Loss=3.7405, Acc=0.3014
  Batch 100: Loss=3.5387, Acc=0.3170
  Batch 150: Loss=3.8311, Acc=0.2919
  Batch 200: Loss=3.7824, Acc=0.2943
  Batch 250: Loss=3.8980, Acc=0.2756
  Batch 300: Loss=3.8767, Acc=0.2805
  Batch 350: Loss=3.8326, Acc=0.2831
  Batch 400: Loss=3.7041, Acc=0.2897
  Batch 450: Loss=3.8431, Acc=0.2790
  Batch 500: Loss=3.7245, Acc=0.2835
  Batch 550: Loss=4.2537, Acc=0.2735
  Batch 600: Loss=4.1298, Acc=0.2633
  Batch 650: Loss=4.0121, Acc=0.2703
  Batch 700: Loss=3.8350, Acc=0.2756

  Train Loss: 3.8029, Train Acc: 0.2962
  Val Loss: 3.8409, Val Acc: 0.3279
  ✓ Saved best model (val_loss=3.8409)

Epoch 17/20
----------------------------------------
  Batch 50: Loss=3.8486, Acc=0.2904
  Batch 100: Loss=3.9192, Acc=0.2821
  Batch 150: Loss=3.7882, Acc=0.3078
  Batch 200: Loss=3.9875, Acc=0.2857
  Batch 250: Loss=3.5822, Acc=0.3130
  Batch 300: Loss=3.7346, Acc=0.2669
  Batch 350: Loss=3.7493, Acc=0.3147
  Batch 400: Loss=4.0997, Acc=0.2546
  Batch 450: Loss=3.7747, Acc=0.3079
  Batch 500: Loss=3.7866, Acc=0.3253
  Batch 550: Loss=3.4981, Acc=0.3287
  Batch 600: Loss=3.6929, Acc=0.3416
  Batch 650: Loss=3.5947, Acc=0.3043
  Batch 700: Loss=3.8188, Acc=0.3043

  Train Loss: 3.7865, Train Acc: 0.2971
  Val Loss: 3.8161, Val Acc: 0.3335
  ✓ Saved best model (val_loss=3.8161)

Epoch 18/20
----------------------------------------
  Batch 50: Loss=3.6793, Acc=0.3059
  Batch 100: Loss=3.8285, Acc=0.3084
  Batch 150: Loss=3.8660, Acc=0.2837
  Batch 200: Loss=3.8325, Acc=0.2774
  Batch 250: Loss=3.6649, Acc=0.3090
  Batch 300: Loss=3.9094, Acc=0.2678
  Batch 350: Loss=3.5543, Acc=0.3199
  Batch 400: Loss=3.7689, Acc=0.3065
  Batch 450: Loss=3.8770, Acc=0.3007
  Batch 500: Loss=3.4717, Acc=0.3139
  Batch 550: Loss=4.0350, Acc=0.2668
  Batch 600: Loss=3.8983, Acc=0.3071
  Batch 650: Loss=3.7164, Acc=0.3132
  Batch 700: Loss=3.7725, Acc=0.3020

  Train Loss: 3.7689, Train Acc: 0.2979
  Val Loss: 3.7941, Val Acc: 0.3366
  ✓ Saved best model (val_loss=3.7941)

Epoch 19/20
----------------------------------------
  Batch 50: Loss=3.6702, Acc=0.3081
  Batch 100: Loss=4.0465, Acc=0.2798
  Batch 150: Loss=3.4461, Acc=0.3173
  Batch 200: Loss=3.6655, Acc=0.3040
  Batch 250: Loss=3.8199, Acc=0.3106
  Batch 300: Loss=3.9389, Acc=0.2928
  Batch 350: Loss=3.6379, Acc=0.3300
  Batch 400: Loss=3.7379, Acc=0.2876
  Batch 450: Loss=3.8226, Acc=0.2900
  Batch 500: Loss=3.9268, Acc=0.3012
  Batch 550: Loss=3.9845, Acc=0.2734
  Batch 600: Loss=3.5496, Acc=0.3278
  Batch 650: Loss=3.7537, Acc=0.2841
  Batch 700: Loss=3.8656, Acc=0.3030

  Train Loss: 3.7533, Train Acc: 0.2995
  Val Loss: 3.7736, Val Acc: 0.3382
  ✓ Saved best model (val_loss=3.7736)

Epoch 20/20
----------------------------------------
  Batch 50: Loss=3.6002, Acc=0.3058
  Batch 100: Loss=3.6824, Acc=0.3270
  Batch 150: Loss=3.3741, Acc=0.3421
  Batch 200: Loss=3.4984, Acc=0.3258
  Batch 250: Loss=3.4980, Acc=0.3201
  Batch 300: Loss=3.5921, Acc=0.3027
  Batch 350: Loss=3.7739, Acc=0.2862
  Batch 400: Loss=3.6234, Acc=0.2766
  Batch 450: Loss=3.5733, Acc=0.3072
  Batch 500: Loss=3.7730, Acc=0.3039
  Batch 550: Loss=3.9450, Acc=0.2781
  Batch 600: Loss=3.8609, Acc=0.2990
  Batch 650: Loss=3.8887, Acc=0.2889
  Batch 700: Loss=3.7450, Acc=0.2907

  Train Loss: 3.7423, Train Acc: 0.3004
  Val Loss: 3.7610, Val Acc: 0.3423
  ✓ Saved best model (val_loss=3.7610)

✓ Training complete. Best validation loss: 3.7610
